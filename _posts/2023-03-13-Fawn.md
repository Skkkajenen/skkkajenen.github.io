---
title: Fawn - Starting Point
author: skkkajenen
date: 2023-03-13 21:20:00 +0100
categories: [Hacking, Writeups]  # Categor칤a principal , categor칤a secundaria
tags: [htb,linux,ftp,startingpoint]     # TAG names should always be lowercase
image: /htb_fawn.png   # Mantener la proporci칩n 1.91 : 1
img_path: /posts/fawn
published: true
---

# Introducci칩n
**Fawn** es la segunda m치quina del **Starting Point** de [HackTheBox][htb]. Al igual que en la primera de las m치quinas ([Meow][meow]) la metodolog칤a consiste en ir dando respuesta a diferentes preguntas que tienen la funci칩n de guiar en la resoluci칩n de estas m치quinas

<div>
    <img src="https://img.shields.io/badge/Sistema-Linux-orange" alt="Sistema-Linux-orange" />
    <img src="https://img.shields.io/badge/Dificultad-VeryEasy-brightgreen" alt="Dificultad-VeryEasy-brightgreen" /> 
</div>

# Resoluci칩n

## Conexi칩n al VPN de HTB
Comenzamos estableciendo conexi칩n por VPN con la plataforma [HackTheBox][htb].
Una vez tengamos IP asignada de la VPN de HTB procedemos a ir a la web de Starting Point para iniciar la m치quina **Fawn**.
Puede trascurrir hasta 2 minutos en reconocer la web que estamos conectados por VPN, llegando en ocasiones a tener que refrescar la p치gina `F5`
Nos asignan en este ejercicio la IP **10.10.15.74**

> Si tienes dudas sobre conectar con la **VPN** de [HackTheBox][htb] te lo explico [**aqu칤**][vpn]
{: .prompt-tip}

## Iniciar la m치quina
Iniciamos la m치quina pulsando sobre el bot칩n

![Bot칩n Spawn Machine](spawn_machine.png)

Tras unos cuantos segundos (en ocasiones puede tardar m치s) se habr치 iniciado correctamente la m치quina y nos mostrar치 la direcci칩n ip de la *m치quina v칤ctima*. En nuestro caso ser치 **10.129.17.247**

### Settarget
Haciendo uso de la herramienta previamente establecida en la ZSH llamada '*settarget*' dejaremos anotada la IP y nombre de la *m치quina v칤ctima* en la parte superior de la Polybar para tener as칤 mayor eficacia. La sintaxis es: `settarget (IP_VICTIMA) (NOMBRE_MAQUINA_VICTIMA)`

~~~bash
settarget 10.129.17.247 Meow
~~~

En la Polybar superior tendremos siempre bien referenciada la *m치quina v칤ctima*:

![settarget](settarget.png)

### Ping
Comprobamos que efectivamente tenemos visible la *m치quina v칤ctima* lanzando un `ping`sobre ella. Con el par치metro `-c 1` le indicamos que tan solo haga un ping. No es necesario m치s.

~~~bash
ping -c 1 10.129.17.247
~~~

Como resultado obtenemos lo siguiente de lo cual destacatemos el TTL y el n칰mero de paquetes enviados / recibidos:

![Ping](ping.png)

* `TTL = 63`
: Este valor (cercano a 64) indica que nos encontramos ante una m치quina **Linux**

> Por defecto valores de `TTL` en torno a ***64*** indica que la m치quina es **Linux** mientras que valores de ***128*** indicar칤a que la m치quina es **Windows**
{: .prompt-info}

* `1 packets transmitted, 1 received`
: Indica que el paquete enviado ha sido recibido con 칠xito por lo tanto => La *m치quina v칤ctima* est치 encendida y tenemos conexi칩n con ella

## Tasks (1/2)
Estas **Tasks** hacen las funciones de *mini-flags* y ayudan guiando la resoluci칩n de la m치quina

1. What does the 3-letter acronym FTP stand for?
: En caso de que no lo sepamos, acudid a Google: *File Transfer Protocol*

2. Which port does the FTP service listen on usually?
: La respuesta ser칤a: *21*

3. What acronym is used for the secure version of FTP?
: Es *SFTP*

4. What is the command we can use to send an ICMP echo request to test our connection to the target?
: En nuestro caso no solo es conocido sino que en este paso ya nos hemos adelantado 游땔. La respuesta es: *ping*

## Reconocimiento con NMAP (PortDiscovery)
>[NMAP][nmap] es una herramienta ampliamente extendida en el reconocimiento de redes as칤 como en el escaneo de puertos, hosts y servicios

Ejecutaremos la instrucci칩n b치sica de reconocimiento con los par치metros que se explican a continuaci칩n:

~~~bash
nmap -p- -sS --min-rate 5000 -n -Pn -vvv --open 10.129.17.247 -oG allPorts
~~~

* `-p-`
: Indicamos que queremos analizar el rango completo de puertos. Del 1 al 65535

* `-sS`
: Especificaci칩n del tipo de escaneo. En este caso SYN Scan que es r치pido a la vez que sigiloso ya que no termina de establecer la conexi칩n y de tal manera puede pasar desapercibido en los logs de conexi칩n

* `--min-rate 5000`
: Acelera el proceso de escane ya que no tramita paquetes cuya velocidad sea inferior a 5000 paquetes por segundo. Esto puede hacer menos sigiloso el escaneo pero m치s r치pido

* `-n`
: Indica que *no* queremos aplicar resoluci칩n *DNS*. M치s velocidad de escaneo

* `-Pn`
: Escaneo de puertos incluso si el host no responde a los ping. Ignora si el host est치 o no online

* `-vvv`
: *Triple verbose* para que los resultados que vaya obteniendo los vaya mostrando por pantalla sin necesidad de acabar el escaneo

* `--open`
: Un puerto principalmente puede estar **Abierto**, **Cerrado** o **Filtrado**. En un principio nos centraremos en aquellos que est치n **Abiertos**

* `-oG allPorts`
: Salida del resultado en un fichero llamado ***allPorts*** en formato *'grepable'* lo cual aportar치 ventajas a la hora de tratarlo posteriormente

El resultado del comando ejecutado ser칤a el siguiente:

![NMAP sS](nmap_ss.png)

Del cual destacamos que el **puerto 21** se encuentra **Abierto**

* `Puerto 21 => FTP`
: El servicio **FTP**, acr칩nimo de **File Transfer Protocol** es el que por defecto funciona sobre el **puerto 21** (abierto en esta m치quina). El servicio **FTP** es usado para realizar transferencia de ficheros entre una m치quina or칤gen y una m치quina destino conectadas ambas por red.

> **FTP** a pesar de tener posibilidad de proteger el acceso con usuario y contrase침a no se podr칤a decir que sea especialmente seguro. Especialmente prestaremos atenci칩n a si el usuario **anonymous** est치 habilitado, en cuyo caso podr칤amos acceder sin necesidad de proporcionar contrase침a
{: .prompt-warning}

## Puertos abiertos (versiones)
Sobre aquellos puertos abiertos en la *m치quina v칤ctima* lanzaremos un comando de NMAP enfocado al descubrimiento de versiones de los servicios que est칠n corriendo sobre los puertos abiertos

~~~bash
nmap -sCV -p23 10.129.17.247 -oN targeted
~~~

* `-sCV` (tambi칠n se puede poner como `-sC -sV`)
: Realiza un escaneo en busca de versiones y comparando con una base de datos de servicios conocidos

* `-p21`
: Indica que se analizar치 en esta caso 칰nicamente el puerto 21

* `-oN targeted`
: Salida del resultado en un fichero llamado ***targeted*** en formato normal de NMAP

El resultado del comando ejecutado ser칤a el siguiente:

![NMAP sCV](nmap_scv.png)

Este escaneo ha aportado informaci칩n sustanciosa para la consecuci칩n de la m치quina:

* `vsftpd 3.0.3`
: Esta ser칤a la versi칩n de FTP de la *m치quina v칤ctima*. Ser칤a 칰til de cara a buscar vulnerabilidades aunque en nuestro caso es la respuesta a la pregunta 5.

* `Anonymous FTP login allowed`
: Es posible conectarse por FTP sin proporcionar contrase침a con el usuario Anonymous

## Tasks (2/2)
Tras el inciso por la fase de reconocimiento realizada con **NMAP**, regresamos a contestar las preguntas para resolver la m치quina:

5. From your scans, what version is FTP running on the target?
: Tras haber realizado la fase de reconocimiento con [NMAP][nmap] tendremos a mano la respuesta: *vsftpd 3.0.3*

6. From your scans, what OS type is running on the target?
: La respuesta es: *Unix*

7. What is the command we need to run in order to display the 'ftp' client help menu?
: De manera general, para obtener ayuda de un comando, se escribe 칠ste seguido de `-h` 칩 `--help`: *ftp -h*

8. What is username that is used over FTP when you want to log in without having an account?
: Como dec칤amos anteriormente, la respuesta es: `anonymous`

> **FTP** permite conectarse con el usuario `anonymous` sin proporcionar contrase침a
{: .prompt-info}

9. What is the response code we get for the FTP message 'Login successful'?
: En la captura de la ejecuci칩n del comando `nmap -sCV` tenemos la respuesta: *320*

10. There are a couple of commands we can use to list the files and directories available on the FTP server. One is dir. What is the other that is a common way to list files on a Linux system.
: Coincide con el que usamos normalmente para listar el contenido de un directorio en Linux: *ls*

11. What is the command used to download the file we found on the FTP server?
: La respuesta es: *get*

## Intrusi칩n
Con el pre-guiado que nos ha aportado el haber respondido a todas y cada una de las preguntas de las tasks tan solo quedar칤a poner en pr치ctica y obtener la flag.

Ejecutamos `ftp 10.129.17.247` y a los pocos segundos nos pedir치 un nombre de `login`donde deberemos rellenar `anonymous`, a continuaci칩n en el campo **password** lo dejaremos en blanco. Ya estar칤amos dentro:

![Connected](connected.png)

Con un `ls` sobre el directorio actual vemos el fichero `flag.txt` que lo descargaremos al directorio de trabajo con el comando `get flag.txt`. A continuaci칩n ya podemos cerrar la conexi칩n **FTP** con el comando `exit`.

Visualizamos la flag con `cat flag.txt`

# Flag
![Root Flag](https://img.shields.io/badge/RootFlag-035db21c881520061c53e0536e44f815-red)



[htb]: https://www.hackthebox.com
[nmap]: https://nmap.org
[vpn]: https://www.skkkajenen.com/posts/Connect-VPN-HTB/
[meow]: https://www.skkkajenen.com/posts/Meow/